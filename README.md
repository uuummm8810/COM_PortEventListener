# COM_PortEventListener

## 概要

ATmega328PとWindowsPC間で通信を行うためのPC側のプログラムです

COMポートから受け取った信号を1byteごとにコンソールに表示します。
同時に、受け取った信号に対応したエクセルのVBAマクロを実行します。

## 目的

大学の講義において苦労した経験から、Excelによる実験データの記録を支援するプログラムとして作成を行いました。
この目的を達成する上で、PC初心者でも扱いやすいようなプログラムを目指しました。

## 動作環境

STK500との通信を目的として作成しましたが、COMポートによる通信を行えるデバイスであれば原理上通信対象は限定されません。
本プログラムはWindows11/10上での動作を確認しています。I/O管理など機能の中核にwindows.hを使用しているため、Windows以外のOSでの動作は保証されません。

## 設計思想

### リソース消費の削減

WaitCommEventによる割り込み待ちを行うことで必要以上にリソースを消費するのを抑えました。仕様上起動して常駐させることになるので、待機中にユーザーの作業に影響を与えない軽量なソフトウェアであることが必要条件であると判断したためです。

### 実行環境の導入不要な仕組み

Excelのマクロを動作させるために、VBScriptをWSHにより動作させるという手法を用いました。WSHはWindowsに標準で搭載されているため、ユーザーに追加インストールを強いることなく利用できます。

### VBScriptによるExcel操作

本プログラムはC言語によって作成されていますが、Excelの操作についてはVBScriptを使用しています。VBScriptはMicrosoftがCOM操作に最適化した言語であり、Excelの操作が非常に用意な言語です。実装にかかる負担軽減になるため、WSHと合わせて採用しました。

## 今後の目標と進捗

- サーバーからマクロのデータを更新するアップデート機能の実装
  - サーバーの構築とインターネットの接続確認のプログラムまでは完了
- 非同期処理の実装
- GUIの実装
