# COM_PortEventListener

## 概要

COMポートから受け取った信号を1byteごとにコンソールに表示します。
同時に、受け取った信号に対応したエクセルのVBAマクロを実行します。

## 目的

STK500に搭載されたATmega328Pとの通信を行うため。

最終的に、マイコンと通信を行いマイコン上のボタンが押されたときに指定のプログラムが実行されるという構造を実現することをゴールとしており、本プログラムはその重要な部分である通信機能の学習および試作品の作成を目的としています。
試作品は完成いたしました。現在はプログラムの堅牢度を高めると同時に、Bluetoothを用いた無線通信を目指しています。

## 動作環境

STK500との通信を目的として作成しましたが、COMポートによる通信を行えるデバイスであれば原理上通信対象は限定されません。

本プログラムはWindows11/10上での動作を確認しています。I/O管理など機能の中核にwindows.hを使用しているため、Windows以外のOSでの動作は保証されません。

## 設計思想

WaitCommEventやgetcharによる割り込み待ちを行うことで必要以上にリソースを消費するのを抑えました。

現在マイコン側の通信プログラムを調整しているため、エラーとなっている箇所の特定がしやすくなるよう標準出力のメッセージを多めに出力しています。
